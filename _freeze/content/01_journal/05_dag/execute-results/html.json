{
  "hash": "ef9de9898432819e6f499657545e1847",
  "result": {
    "markdown": "---\ntitle: \"Directed Acyclic Graphs\"\n---\n\n\n::: callout-note\nYou can delete everything in here and start fresh.\n:::\n\n* Think about example from previous chapter (parking spots) and draw the DAG.\n\nWe take the variables as follows\n* X is the Parking spots\n* Y is the Sales\n* Z is the Location\n\nWe make the folloing assumption for the dependancies,\n* X and Z: Dependant, Location affects the size of the parking spots\n* Z and Y: Dependant, Location affects the Sales\n* X and Y, conditional on Z: Dependant as the size of the parking lot affects\nsales in a fixed location\n\n::: {.cell hash='05_dag_cache/html/unnamed-chunk-1_88a69d3b888180175acec166cbb29f39'}\n\n```{.r .cell-code}\nlibrary(dagitty)\nlibrary(ggdag)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n#> \n#> Attaching package: 'ggdag'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n#> The following object is masked from 'package:stats':\n#> \n#>     filter\n```\n:::\n\n```{.r .cell-code}\nlibrary(ggplot2)\n# Chain\nchain <- dagify(\n    X ~ Z,\n    Y ~ Z,\n    Y ~ X,\n    coords = list(x = c(Y = 3, Z = 2, X = 1),\n                  y = c(Y = 0, Z = 1, X = 0)),\n    labels = list(X = \"Parking Spots\",\n                Y = \"Sales\", \n                Z = \"Location\")\n)\n\n# Plot DAG\nggdag(chain) +\n    geom_dag_point(color = \"red\") +\n    geom_dag_text(color = \"white\") +\n    geom_dag_edges(edge_color = \"black\")+\n    geom_dag_label_repel(aes(label = label))\n```\n\n::: {.cell-output-display}\n![](05_dag_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n:::\n\n\n* In the data, you find three variables: satisfaction, follow_ups and subscription. Perform the     following steps:\n\n  + regress satisfaction on follow_ups\n\n  + regress satisfaction on follow_ups and account for subscription\n  \n\n::: {.cell hash='05_dag_cache/html/unnamed-chunk-2_97d7e940f2b154538e6885d5581684ae'}\n\n```{.r .cell-code}\nlibrary(ggplot2)\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n#> ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n#> ✔ dplyr     1.1.4     ✔ readr     2.1.4\n#> ✔ forcats   1.0.0     ✔ stringr   1.5.1\n#> ✔ lubridate 1.9.3     ✔ tibble    3.2.1\n#> ✔ purrr     1.0.2     ✔ tidyr     1.3.0\n#> ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n#> ✖ dplyr::filter() masks ggdag::filter(), stats::filter()\n#> ✖ dplyr::lag()    masks stats::lag()\n#> ℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n:::\n\n```{.r .cell-code}\nlibrary(dplyr)\ndf <- readRDS(\"C:/Users/Sandipan Mukherjee/Documents/GitHub/cdsba-msandipan/Causal_Data_Science_Data/customer_sat.rds\")\n\n# Not Conditioned\nlm_1<-lm(satisfaction ~ follow_ups,data=df)\nprint(\"Not conditioned coefficients:\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> [1] \"Not conditioned coefficients:\"\n```\n:::\n\n```{.r .cell-code}\nlm_1$coefficients\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> (Intercept)  follow_ups \n#>   78.886047   -3.309302\n```\n:::\n\n```{.r .cell-code}\n#Plot\nlm_not_cond <- ggplot(df, aes(x = follow_ups, y = satisfaction ))+\n  geom_point()+\n  stat_smooth(method = \"lm\", se = F)\nlm_not_cond\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n#> `geom_smooth()` using formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](05_dag_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n\n```{.r .cell-code}\n#Conditioned\nlm_2<-lm(satisfaction ~ follow_ups,data=df[df$subscription == \"Elite\", ])\nlm_3<-lm(satisfaction ~ follow_ups,data=df[df$subscription == \"Premium\", ])\nlm_4<-lm(satisfaction ~ follow_ups,data=df[df$subscription == \"Premium+\", ])\nprint(\"Conditioned coefficients accounting for Elite:\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> [1] \"Conditioned coefficients accounting for Elite:\"\n```\n:::\n\n```{.r .cell-code}\nlm_2$coefficients\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> (Intercept)  follow_ups \n#>   31.307692    1.653846\n```\n:::\n\n```{.r .cell-code}\nprint(\"Conditioned coefficients accounting for Premium:\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> [1] \"Conditioned coefficients accounting for Premium:\"\n```\n:::\n\n```{.r .cell-code}\nlm_3$coefficients\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> (Intercept)  follow_ups \n#>   70.076923    3.076923\n```\n:::\n\n```{.r .cell-code}\nprint(\"Conditioned coefficients accounting for Premium+:\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> [1] \"Conditioned coefficients accounting for Premium+:\"\n```\n:::\n\n```{.r .cell-code}\nlm_4$coefficients\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> (Intercept)  follow_ups \n#>       47.95        1.75\n```\n:::\n\n```{.r .cell-code}\n#Plot\nlm_cond <- ggplot(df, aes(x = follow_ups, y = satisfaction,color= subscription ))+ geom_point()+stat_smooth(method = \"lm\", se = F)\nlm_cond\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n#> `geom_smooth()` using formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](05_dag_files/figure-html/unnamed-chunk-2-2.png){width=672}\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\r\n<script src=\"../../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}