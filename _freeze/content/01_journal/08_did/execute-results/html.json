{
  "hash": "9f1f693e1fc3a5ff322f0bfa9daeb488",
  "result": {
    "markdown": "---\ntitle: \"Difference-in-Differences\"\n---\n\n\n\n\n* Manually computing the mean satisfaction for treated and control hospitals before and after the treatment\n\n::: {.cell hash='08_did_cache/html/unnamed-chunk-2_0fb6a90f7e89326d8d22c7ccbb3af494'}\n\n```{.r .cell-code}\n#Check Correlation\ndf <- readRDS(\"~/GitHub/cdsba-msandipan/Causal_Data_Science_Data/hospdd.rds\")\n\ndf_rep<-df\nhosp<-unique(df$hospital)\ndf_rep$hospital<-replace(df$hospital,df$hospital %in% sample(hosp,18),0)\ndf_rep$hospital<-replace(df_rep$hospital,df_rep$hospital!=0,1)\n\nbefore_control <- df_rep %>%\n  filter(procedure == 0,hospital==0) %>%pull(satis)\nbefore_treatment <- df_rep %>%\n  filter(procedure == 0,hospital==1) %>%pull(satis)\n\nafter_control <- df_rep %>%\n  filter(procedure == 1,hospital==0) %>%pull(satis)\nafter_treatment <- df_rep %>%\n  filter(procedure == 1,hospital==1) %>%pull(satis)\n\ndiff_control <- mean(before_control) - mean(after_control)\ndiff_treatment <- mean(before_treatment) - mean(after_treatment)\n\ndiff_diff<-diff_treatment-diff_control\n```\n:::\n\n\n* Using a linear regression to compute the estimate. Also, include group and time fixed effects in the regression, i.e. one regressor for each month and one regressor for each hospital:\n\n::: {.cell hash='08_did_cache/html/unnamed-chunk-3_c5e80a54ed03afc95081a97b76a1bf7b'}\n\n```{.r .cell-code}\nlm_1<-lm(satis~procedure*hospital,data=df_rep)\nsummary(lm_1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> \n#> Call:\n#> lm(formula = satis ~ procedure * hospital, data = df_rep)\n#> \n#> Residuals:\n#>     Min      1Q  Median      3Q     Max \n#> -3.1937 -0.6604 -0.0896  0.5611  5.4760 \n#> \n#> Coefficients:\n#>                    Estimate Std. Error t value Pr(>|t|)    \n#> (Intercept)         3.46615    0.02017 171.830  < 2e-16 ***\n#> procedure           0.77078    0.04702  16.393  < 2e-16 ***\n#> hospital           -0.07160    0.02620  -2.733  0.00629 ** \n#> procedure:hospital  0.26607    0.05883   4.523  6.2e-06 ***\n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#> \n#> Residual standard error: 0.9833 on 7364 degrees of freedom\n#> Multiple R-squared:  0.133,\tAdjusted R-squared:  0.1326 \n#> F-statistic: 376.4 on 3 and 7364 DF,  p-value: < 2.2e-16\n```\n:::\n\n```{.r .cell-code}\nlm_2<-lm(satis~procedure*(hospital+month),data=df_rep)\nsummary(lm_2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> \n#> Call:\n#> lm(formula = satis ~ procedure * (hospital + month), data = df_rep)\n#> \n#> Residuals:\n#>     Min      1Q  Median      3Q     Max \n#> -3.2055 -0.6605 -0.0915  0.5628  5.4878 \n#> \n#> Coefficients:\n#>                     Estimate Std. Error t value Pr(>|t|)    \n#> (Intercept)         3.511552   0.028537 123.052  < 2e-16 ***\n#> procedure           0.682065   0.133727   5.100 3.47e-07 ***\n#> hospital           -0.073260   0.026203  -2.796  0.00519 ** \n#> month              -0.014180   0.006305  -2.249  0.02455 *  \n#> procedure:hospital  0.267723   0.058820   4.552 5.41e-06 ***\n#> procedure:month     0.022054   0.023332   0.945  0.34458    \n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#> \n#> Residual standard error: 0.9831 on 7362 degrees of freedom\n#> Multiple R-squared:  0.1336,\tAdjusted R-squared:  0.133 \n#> F-statistic:   227 on 5 and 7362 DF,  p-value: < 2.2e-16\n```\n:::\n\n```{.r .cell-code}\nlm_3<-lm(satis~procedure*(as.factor(hospital)+as.factor(month)),data=df_rep)\nsummary(lm_3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> \n#> Call:\n#> lm(formula = satis ~ procedure * (as.factor(hospital) + as.factor(month)), \n#>     data = df_rep)\n#> \n#> Residuals:\n#>     Min      1Q  Median      3Q     Max \n#> -3.2073 -0.6623 -0.0954  0.5605  5.4983 \n#> \n#> Coefficients: (3 not defined because of singularities)\n#>                                 Estimate Std. Error t value Pr(>|t|)    \n#> (Intercept)                     3.489254   0.027861 125.236  < 2e-16 ***\n#> procedure                       0.842756   0.075630  11.143  < 2e-16 ***\n#> as.factor(hospital)1           -0.073711   0.026213  -2.812  0.00494 ** \n#> as.factor(month)2              -0.009608   0.039684  -0.242  0.80871    \n#> as.factor(month)3               0.021969   0.039684   0.554  0.57988    \n#> as.factor(month)4              -0.042392   0.048197  -0.880  0.37913    \n#> as.factor(month)5              -0.082292   0.048197  -1.707  0.08779 .  \n#> as.factor(month)6              -0.052056   0.048197  -1.080  0.28014    \n#> as.factor(month)7              -0.081521   0.048197  -1.691  0.09080 .  \n#> procedure:as.factor(hospital)1  0.268174   0.058838   4.558 5.25e-06 ***\n#> procedure:as.factor(month)2           NA         NA      NA       NA    \n#> procedure:as.factor(month)3           NA         NA      NA       NA    \n#> procedure:as.factor(month)4    -0.075073   0.092972  -0.807  0.41942    \n#> procedure:as.factor(month)5     0.006161   0.092972   0.066  0.94716    \n#> procedure:as.factor(month)6    -0.053165   0.092972  -0.572  0.56745    \n#> procedure:as.factor(month)7           NA         NA      NA       NA    \n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#> \n#> Residual standard error: 0.9833 on 7355 degrees of freedom\n#> Multiple R-squared:  0.1339,\tAdjusted R-squared:  0.1325 \n#> F-statistic: 94.77 on 12 and 7355 DF,  p-value: < 2.2e-16\n```\n:::\n:::\n\nInclusion of the second method would be beneficial as the inclusion of the third method leads to 3 coefficients not defined because of singularities.",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\r\n<script src=\"../../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}