{
  "hash": "79a9d2921e5bf708e0acac2303ab972a",
  "result": {
    "markdown": "---\ntitle: \"Regression and Statistical Inference\"\n---\n\n\n::: callout-note\nYou can delete everything in here and start fresh.\n:::\n* Read the data and check the dimensions. How many rows and how many columns does the data have?\n\n181 rows and 82 columns\n\n* Use appropriate commands to get a more detailed look at the data. What data types do you see? How do numbers differ from strings regarding their data type?\n\nstr() gives us a quick overview of the different datatypes. typeof() gives us a better view of the type of integer data present. \n\n\n::: {.cell hash='03_regression_cache/html/unnamed-chunk-1_9c2bb4120eb0e30ed126fd7a59b1a05b'}\n\n```{.r .cell-code}\ndf <- readRDS(\"C:/Users/Sandipan Mukherjee/Documents/GitHub/cdsba-msandipan/Causal_Data_Science_Data/car_prices.rds\")\n\nstr(df)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> tibble [181 Ã— 22] (S3: tbl_df/tbl/data.frame)\n#>  $ aspiration      : chr [1:181] \"std\" \"std\" \"std\" \"std\" ...\n#>  $ doornumber      : chr [1:181] \"two\" \"two\" \"two\" \"four\" ...\n#>  $ carbody         : chr [1:181] \"convertible\" \"convertible\" \"hatchback\" \"sedan\" ...\n#>  $ drivewheel      : chr [1:181] \"rwd\" \"rwd\" \"rwd\" \"fwd\" ...\n#>  $ enginelocation  : chr [1:181] \"front\" \"front\" \"front\" \"front\" ...\n#>  $ wheelbase       : num [1:181] 88.6 88.6 94.5 99.8 99.4 ...\n#>  $ carlength       : num [1:181] 169 169 171 177 177 ...\n#>  $ carwidth        : num [1:181] 64.1 64.1 65.5 66.2 66.4 66.3 71.4 71.4 71.4 67.9 ...\n#>  $ carheight       : num [1:181] 48.8 48.8 52.4 54.3 54.3 53.1 55.7 55.7 55.9 52 ...\n#>  $ curbweight      : num [1:181] 2548 2548 2823 2337 2824 ...\n#>  $ enginetype      : chr [1:181] \"dohc\" \"dohc\" \"ohcv\" \"ohc\" ...\n#>  $ cylindernumber  : chr [1:181] \"four\" \"four\" \"six\" \"four\" ...\n#>  $ enginesize      : num [1:181] 130 130 152 109 136 136 136 136 131 131 ...\n#>  $ fuelsystem      : chr [1:181] \"mpfi\" \"mpfi\" \"mpfi\" \"mpfi\" ...\n#>  $ boreratio       : num [1:181] 3.47 3.47 2.68 3.19 3.19 3.19 3.19 3.19 3.13 3.13 ...\n#>  $ stroke          : num [1:181] 2.68 2.68 3.47 3.4 3.4 3.4 3.4 3.4 3.4 3.4 ...\n#>  $ compressionratio: num [1:181] 9 9 9 10 8 8.5 8.5 8.5 8.3 7 ...\n#>  $ horsepower      : num [1:181] 111 111 154 102 115 110 110 110 140 160 ...\n#>  $ peakrpm         : num [1:181] 5000 5000 5000 5500 5500 5500 5500 5500 5500 5500 ...\n#>  $ citympg         : num [1:181] 21 21 19 24 18 19 19 19 17 16 ...\n#>  $ highwaympg      : num [1:181] 27 27 26 30 22 25 25 25 20 22 ...\n#>  $ price           : num [1:181] 13495 16500 16500 13950 17450 ...\n```\n:::\n\n```{.r .cell-code}\ntypeof(df$wheelbase)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> [1] \"double\"\n```\n:::\n:::\n\n\n* Run a linear regression. You want to explain what factors are relevant for the pricing of a car.\n\nRelevant Factors based on p-value:\n* carbody\n* carwidth \n* enginelocation\n* stroke  \n* peakrpm\n* enginesize \n\nThese factors were chosen based on their p-values indicating that the alternative hypothesis was true instead of the null hypothesis stating that there is a correlation between the variables in question.\n\n\n::: {.cell hash='03_regression_cache/html/unnamed-chunk-2_9d161062b910ca7d2efa73dfcc964108'}\n\n```{.r .cell-code}\nlm_imp <- lm(price ~ carbody+carwidth+enginelocation+stroke+peakrpm+enginesize, data = df)\nsummary(lm_imp)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> \n#> Call:\n#> lm(formula = price ~ carbody + carwidth + enginelocation + stroke + \n#>     peakrpm + enginesize, data = df)\n#> \n#> Residuals:\n#>     Min      1Q  Median      3Q     Max \n#> -8973.1 -1644.5  -136.5  1265.1 15085.1 \n#> \n#> Coefficients:\n#>                      Estimate Std. Error t value Pr(>|t|)    \n#> (Intercept)        -6.697e+04  1.035e+04  -6.472 9.85e-10 ***\n#> carbodyhardtop     -4.116e+03  1.624e+03  -2.534 0.012181 *  \n#> carbodyhatchback   -3.659e+03  1.295e+03  -2.826 0.005269 ** \n#> carbodysedan       -2.464e+03  1.278e+03  -1.928 0.055483 .  \n#> carbodywagon       -3.624e+03  1.389e+03  -2.609 0.009888 ** \n#> carwidth            9.752e+02  1.661e+02   5.872 2.19e-08 ***\n#> enginelocationrear  1.124e+04  2.112e+03   5.321 3.20e-07 ***\n#> stroke             -2.422e+03  7.119e+02  -3.402 0.000833 ***\n#> peakrpm             1.898e+00  5.516e-01   3.442 0.000726 ***\n#> enginesize          1.311e+02  8.936e+00  14.676  < 2e-16 ***\n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#> \n#> Residual standard error: 2864 on 171 degrees of freedom\n#> Multiple R-squared:  0.8803,\tAdjusted R-squared:  0.874 \n#> F-statistic: 139.7 on 9 and 171 DF,  p-value: < 2.2e-16\n```\n:::\n\n```{.r .cell-code}\nconfint(lm_imp, level = 0.95)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#>                            2.5 %        97.5 %\n#> (Intercept)        -8.740074e+04 -46545.470512\n#> carbodyhardtop     -7.321743e+03   -909.386711\n#> carbodyhatchback   -6.215052e+03  -1103.700157\n#> carbodysedan       -4.985517e+03     58.389405\n#> carbodywagon       -6.366137e+03   -882.064242\n#> carwidth            6.473973e+02   1303.044319\n#> enginelocationrear  7.068573e+03  15406.356002\n#> stroke             -3.827414e+03  -1016.802715\n#> peakrpm             8.096928e-01      2.987167\n#> enginesize          1.135026e+02    148.779568\n```\n:::\n:::\n\n\n* Choose one regressor and\n\n  + explain what data type it is and what values it can take on\n  + what effect is has on the price and what changing the value would have as a result\n  + whether its effect is statistically significant.\n  \nWe can choose to look at the factor \"Peak RPM\". This factor has integer values ranging from 4200 to 6600. We see that it has a positive effect on the price of the car. As the \"Peak RPM\" increases the price increases and indicated by the positive coefficient in the linear function. From the p-value 0.000726 we can infer that this factor is highly statistically significant for the inference of the car prices. \n\n\n* Add a variable seat_heating to the data and assign a value TRUE for all observations. You can use e.g. df %>% mutate(new_variable = value). Assign it to a new object and run a regression. What coefficient do you get for the new variable seat_heating and how can you explain it?\n\n::: {.cell hash='03_regression_cache/html/unnamed-chunk-3_e03829dbbff0f2194a70cebc697bea36'}\n\n```{.r .cell-code}\nlibrary(dplyr)\n```\n:::\n\n::: {.cell hash='03_regression_cache/html/unnamed-chunk-4_f7f3434cacc28353cf5b65f485fe0d64'}\n\n```{.r .cell-code}\ndf<- df %>% mutate(seat_heating = TRUE)\nlm_imp <- lm(price ~ carbody+carwidth+enginelocation+stroke+peakrpm+enginesize+seat_heating, data = df)\nsummary(lm_imp)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> \n#> Call:\n#> lm(formula = price ~ carbody + carwidth + enginelocation + stroke + \n#>     peakrpm + enginesize + seat_heating, data = df)\n#> \n#> Residuals:\n#>     Min      1Q  Median      3Q     Max \n#> -8973.1 -1644.5  -136.5  1265.1 15085.1 \n#> \n#> Coefficients: (1 not defined because of singularities)\n#>                      Estimate Std. Error t value Pr(>|t|)    \n#> (Intercept)        -6.697e+04  1.035e+04  -6.472 9.85e-10 ***\n#> carbodyhardtop     -4.116e+03  1.624e+03  -2.534 0.012181 *  \n#> carbodyhatchback   -3.659e+03  1.295e+03  -2.826 0.005269 ** \n#> carbodysedan       -2.464e+03  1.278e+03  -1.928 0.055483 .  \n#> carbodywagon       -3.624e+03  1.389e+03  -2.609 0.009888 ** \n#> carwidth            9.752e+02  1.661e+02   5.872 2.19e-08 ***\n#> enginelocationrear  1.124e+04  2.112e+03   5.321 3.20e-07 ***\n#> stroke             -2.422e+03  7.119e+02  -3.402 0.000833 ***\n#> peakrpm             1.898e+00  5.516e-01   3.442 0.000726 ***\n#> enginesize          1.311e+02  8.936e+00  14.676  < 2e-16 ***\n#> seat_heatingTRUE           NA         NA      NA       NA    \n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#> \n#> Residual standard error: 2864 on 171 degrees of freedom\n#> Multiple R-squared:  0.8803,\tAdjusted R-squared:  0.874 \n#> F-statistic: 139.7 on 9 and 171 DF,  p-value: < 2.2e-16\n```\n:::\n:::\n\n\nThe coefficients obtained for the new variable \"seat_heating\" is NA. This can be explained by the fact that since all the values are True thereby this variable is linearly related to other variable leaving us no unique solution to the regression. ",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\r\n<script src=\"../../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}